# 稀疏编码

真实世界的信息是冗余的，存在内部结构，因此不需要完整输入空间的每个部分来表示，可以使用较低纬度的方法表示而不会丢失输入的特征。

1. 稀疏编码通过选择合适的基向量和权重来实现对输入数据的稀疏表示，将输入数据表示为这些权重与相应基向量的线性组合，是一种通过使用少量的非零权重来表示输入数据的方法。
2. 目标是通过使用少量的非零权重来表示输入数据，从而捕捉输入数据的关键特征并减少冗余信息，提供有效的数据压缩和重建缺失区域的能力。
3. 可以通过最小化稀疏表示的误差来实现，同时还可以应用正则化项以鼓励稀疏性。常见的优化方法是使用迭代优化算法，例如迭代收缩阈值（Iterative Shrinkage-Thresholding）算法或坐标下降（Coordinate Descent）算法。
4. 应用于特征提取、图像去噪和图像压缩，也可以作为深度学习模型的预处理步骤或特征学习的一部分。

# 稀疏自编码

一种无监督学习方法

在稀疏自编码中，额外的约束被加入以鼓励编码器产生稀疏的表示。稀疏性的约束通常通过引入稀疏性正则化项来实现，最常见的是L1正则化。

## 1. 超完备字典

1. 基向量的数量远大于输入向量的维度
2. 更强的表达能力
3. 高效还原复杂分布

实现稀疏编码通常需要使用字典来表示基函数或原子。字典是稀疏编码的关键组成部分，它包含了一组基函数，用于线性组合来表示数据。

在传统的稀疏编码方法中，字典是一个矩阵，其中每列表示一个基函数或原子。通过将数据表示为字典中基函数的线性组合，并施加稀疏性约束，可以实现稀疏编码。稀疏性约束通常以L1范数或L0范数的方式应用于编码系数，以促使编码系数中的大部分元素为零，从而实现稀疏表示。

然而，也存在一些无字典的稀疏编码方法。例如，基于稀疏自编码器的方法可以自动学习无需显式字典的稀疏表示。在这种方法中，网络的隐含层可以被看作是一种隐式的字典，它通过学习数据的结构来实现稀疏表示。

总的来说，大多数实现稀疏编码的方法都涉及字典的使用，但也有一些无字典的方法存在。具体使用哪种方法取决于问题的需求和所采用的算法。

## 2. 训练过程

### 编码

输入数据通过编码器，经过一系列的隐藏层进行非线性变换，得到稀疏的低维表示。在这个过程中，稀疏性正则化项会鼓励隐藏层单元中的大部分激活值趋近于零，实现稀疏性。

### 解码

稀疏的低维表示通过解码器进行反向变换，逐层重建原始输入数据。最终的重建结果与原始输入进行比较，通过最小化重建误差来优化网络参数。

## 3. 缺点

1. (如果使用字典学习的方法)训练超完备字典需要大量的高质量数据
2. 过多的非激活参数导致训练过程漫长
3. L1范数在 loss 中的某些位置不可导，模型难以收敛

# 稀疏卷积 Sparse Convolution

## 1. 构建 Input Hash Table 和 Output Hash Table

稀疏卷积可以高效地处理稀疏数据，提高计算速度，并节省计算资源。

输入数据通常是稀疏的，意味着大部分元素都是零值，只有少数非零元素。

在传统的卷积计算中，为了进行卷积操作，需要对输入数据的每一个位置都进行乘法运算和求和操作，包括那些值为零的位置，这会导致大量的**冗余**计算。

**Input Hash Table**：存储输入数据中的非零元素及其位置信息的表格。可以快速定位输入数据中的非零元素，而不必对所有位置进行遍历。

**Output Hash Table**：存储输出数据中的非零元素及其位置信息的表格。可以快速定位输出数据中的非零元素，避免对所有位置进行遍历。

1. 先从 Input Hash Table 中获取非零元素和它们的位置信息
2. 然后根据卷积核的大小和步长，计算输出数据中的位置
3. 将乘法运算和求和操作仅限于这些有效的位置上，从而大大减少了计算量

## 2. 构建 Rulebook (规则手册)

Rulebook 是一种数据结构，用于存储输入数据和输出数据之间的映射规则，从而避免冗余计算并加速稀疏卷积的运算。

Rulebook 存储了输入数据的非零元素位置和卷积核的权重之间的映射规则。这样，在进行稀疏卷积计算时，只需要根据 Rulebook 中的映射规则来选择有效的非零元素和对应的权重进行乘法运算，并将结果累加到相应的输出位置上。

## 3. Computation Pipeline (计算管道)

计算管道是由一系列计算步骤组成的流水线，每个步骤都负责不同的计算操作，通过流水线的方式，将稀疏卷积的计算过程拆分为多个阶段，从而实现并行计算和减少计算延迟。

计算管道的优化效果在于它能够将稀疏卷积的计算过程拆分为多个阶段，每个阶段可以并行处理数据，从而提高计算效率。

此外，通过构建哈希表和规则表，计算管道避免了对无效位置进行计算，减少了冗余计算，进一步提高了稀疏卷积的计算速度。



[参考资料1](https://www.bilibili.com/video/BV1yK4y1Y7hd/?spm_id_from=333.999.0.0&vd_source=37fcec25f2327f81f5fcc1392e6da46c)

[参考资料2](https://zhuanlan.zhihu.com/p/179053082)

[参考资料3](https://zhuanlan.zhihu.com/p/382365889)